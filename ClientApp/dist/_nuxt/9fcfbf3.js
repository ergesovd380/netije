(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{1892:function(t,e,n){"use strict";var o=n(49),l=(n(4),{components:{DxTextArea:o.DxTextArea},props:{value:{type:String,default:function(){return""}},onValueChanged:{type:Function,default:function(){return function(){}}}},data:function(){return{currentValue:this.value}},methods:{}}),r=n(7),component=Object(r.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",[n("DxTextArea",{attrs:{value:t.currentValue,height:90,"on-value-changed":function(e){return t.onValueChanged(e.value)}},on:{"update:value":function(e){t.currentValue=e}}})],1)}),[],!1,null,null,null);e.a=component.exports},2316:function(t,e,n){"use strict";n.r(e);var o=n(14),l=n(68),r=n(27),d=n(103),c=n(4),x=n(1892),m=n(1070),v={components:{textArea:x.a,Header:d.a,DxSearchPanel:m.DxSearchPanel,DxColumn:m.DxColumn,DxEditing:m.DxEditing,DxHeaderFilter:m.DxHeaderFilter,DxScrolling:m.DxScrolling,DxLookup:m.DxLookup,DxRequiredRule:m.DxRequiredRule,DxPatternRule:m.DxPatternRule,DxAsyncRule:m.DxAsyncRule,DxExport:m.DxExport,DxColumnChooser:m.DxColumnChooser,DxColumnFixing:m.DxColumnFixing,DxFilterRow:m.DxFilterRow,DxStateStoring:m.DxStateStoring,DxEmailRule:m.DxEmailRule,DxTreeList:m.DxTreeList},data:function(){return{dataSource:this.$dxStore({key:"id",loadUrl:c.a.company.BusinessUnit,insertUrl:c.a.company.BusinessUnit,updateUrl:c.a.company.BusinessUnit,removeUrl:c.a.company.BusinessUnit}),entityType:r.a.BusinessUnit,statusDataSource:this.$store.getters["status/status"](this),onRegionIdChanged:function(t,e){t.localityId=null,this.defaultSetCellValue(t,e)},codePattern:this.$store.getters["globalProperties/whitespacePattern"],companyStore:{store:this.$dxStore({key:"id",loadUrl:c.a.company.BusinessUnit}),paginate:!0,filter:["status","=",l.b.Active]}}},methods:{selectBussinesUnit:function(t){this.$refs.bussinesUnit.instance.editRow(t.rowIndex)},onInitNewRow:function(t){t.data.status=this.statusDataSource[l.b.Active].id,0===t.data.headCompanyId&&(t.data.headCompanyId=null)},onRowUpdating:function(t){t.newData=Object.assign(t.oldData,t.newData)},allowDeleting:function(t){return t.row.data.isSystem?!t.row.data.isSystem:this.$store.getters["permissions/allowDeleting"](this.entityType)},getActiveRegions:function(t){return{store:this.$dxStore({key:"id",loadUrl:c.a.sharedDirectory.Region}),paginate:!0,filter:t.data?["status","=",l.b.Active,"or","id","=",t.data.regionId]:void 0}},getActiveLocalities:function(t){return{store:this.$dxStore({key:"id",loadUrl:c.a.sharedDirectory.Locality}),paginate:!0,filter:t.data?["regionId","=",t.data.regionId,"or","status","=",l.b.Active,"or","id","=",t.data.localityId]:void 0}},getActiveBanks:function(t){return{store:this.$dxStore({key:"id",loadUrl:c.a.contragents.Bank}),paginate:!0,filter:t.data?["status","=",l.b.Active,"or","id","=",t.data.bankId]:void 0}},getActiveEmployees:function(t){return{store:this.$dxStore({key:"id",loadUrl:c.a.company.Employee}),paginate:!0,filter:t.data?["status","=",l.b.Active,"or","id","=",t.data.ceo]:void 0}},validateEntityExists:function(t){var e=t.column.dataField;return this.$customValidator.BusinnesUnitDataFieldValueNotExists(Object(o.a)({id:t.data.id},e,t.value),e)},onValueChanged:function(t,e){e.setValue(t),e.component.updateDimensions()}}},D=n(7),component=Object(D.a)(v,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("main",[o("Header",{attrs:{headerTitle:t.$t("menu.businessUnit")}}),t._v(" "),o("DxTreeList",{ref:"bussinesUnit",attrs:{"remoteOperations:":"","{":"","filtering:":"","true,sorting:":"","true,grouping:":"",true:"","}":"","parent-id-expr":"headCompanyId","data-source":t.dataSource,errorRowEnabled:!1,"show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"load-panel":{enabled:!0,indicatorSrc:n(221)},onRowDblClick:t.selectBussinesUnit},on:{"row-updating":t.onRowUpdating,"init-new-row":t.onInitNewRow},scopedSlots:t._u([{key:"textAreaEditor",fn:function(e){return[o("textArea",{attrs:{value:e.data.value,"on-value-changed":function(n){return t.onValueChanged(n,e.data)}}})]}}])},[o("DxSearchPanel",{attrs:{position:"after",visible:!0}}),t._v(" "),o("DxFilterRow",{attrs:{visible:!0}}),t._v(" "),o("DxHeaderFilter",{attrs:{visible:!0}}),t._v(" "),o("DxColumnChooser",{attrs:{enabled:!0}}),t._v(" "),o("DxColumnFixing",{attrs:{enabled:!0}}),t._v(" "),o("DxScrolling",{attrs:{mode:"virtual"}}),t._v(" "),o("DxStateStoring",{attrs:{enabled:!0,type:"localStorage","storage-key":"businessUnit"}}),t._v(" "),o("DxEditing",{attrs:{"allow-updating":t.$store.getters["permissions/allowUpdating"](t.entityType),"allow-deleting":t.allowDeleting,"allow-adding":t.$store.getters["permissions/allowCreating"](t.entityType),useIcons:!0,mode:"form"}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"name",caption:t.$t("shared.name"),"data-type":"string"}},[o("DxRequiredRule",{attrs:{message:t.$t("shared.nameRequired")}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"headCompanyId",caption:t.$t("companyStructure.fields.headCompany")}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.companyStore,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"code",caption:t.$t("shared.code"),visible:!1}},[o("DxPatternRule",{attrs:{"ignore-empty-value":!1,pattern:t.codePattern,message:t.$t("validation.valueMustNotContainsSpaces")}}),t._v(" "),o("DxAsyncRule",{attrs:{reevaluate:!1,"ignore-empty-value":!0,message:t.$t("shared.codeAlreadyExists"),"validation-callback":t.validateEntityExists}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"tin",caption:t.$t("translations.fields.tin"),visible:!1}},[o("DxPatternRule",{attrs:{"ignore-empty-value":!1,pattern:t.codePattern,message:t.$t("translations.fields.tinRule")}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"regionId",caption:t.$t("translations.fields.regionId"),"set-cell-value":t.onRegionIdChanged}},[o("DxRequiredRule",{attrs:{message:t.$t("translations.fields.regionIdRequired")}}),t._v(" "),o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getActiveRegions,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"localityId",caption:t.$t("translations.fields.localityId"),visible:!1}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getActiveLocalities,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"phones",caption:t.$t("translations.fields.phones")}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"legalName",caption:t.$t("translations.fields.legalName"),visible:!1}},[o("DxRequiredRule",{attrs:{message:t.$t("translations.fields.legalNameRequired")}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"legalAddress",caption:t.$t("translations.fields.legalAddress"),visible:!1}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"postalAddress",caption:t.$t("translations.fields.postAddress"),visible:!1}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"ceo",caption:t.$t("translations.fields.ceo"),visible:!0}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getActiveEmployees,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"email",caption:t.$t("translations.fields.email"),visible:!1}},[o("DxEmailRule",{attrs:{message:t.$t("translations.fields.emailRule")}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"homepage",caption:t.$t("translations.fields.webSite"),visible:!1}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"account",caption:t.$t("translations.fields.account"),visible:!1}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"bankId",caption:t.$t("translations.fields.bankId"),visible:!1}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getActiveBanks,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"status",caption:t.$t("translations.fields.status")}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.statusDataSource,"value-expr":"id","display-expr":"status"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"note",caption:t.$t("translations.fields.note"),visible:!1,"edit-cell-template":"textAreaEditor"}})],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);