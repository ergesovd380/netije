(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{1984:function(t,e,n){var content=n(2127);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(38).default)("1fcf8b5b",content,!0,{sourceMap:!1})},2126:function(t,e,n){"use strict";n(1984)},2127:function(t,e,n){var r=n(25)(!1);r.push([t.i,"\n.navBar[data-v-ccef87cc] {\r\n  margin: 5px 0px;\n}\r\n",""]),t.exports=r},2270:function(t,e,n){"use strict";n.r(e);var r=n(5),o=(n(30),n(48),n(40),n(50),n(51),n(14)),c=(n(290),n(64),n(43),n(576)),l=n(67),m=n(569),d={components:{DxDataGrid:l.DxDataGrid,DxColumn:l.DxColumn,DxEditing:l.DxEditing,DxLookup:l.DxLookup,recipientSelectBox:m.a},props:{currentMembers:{type:Array,default:[]}},data:function(){return{accessRightStore:{store:[{id:0,name:this.$t("attachmentAccessRight.btns.Read")},{id:1,name:this.$t("attachmentAccessRight.btns.Update")},{id:2,name:this.$t("attachmentAccessRight.btns.FullAccess")}]}}},computed:{members:function(){return this.currentMembers}},watch:{members:function(t){this.updateMembers(t)}},methods:{onValueChanged:function(t,e){e.setValue(t),e.component.updateDimensions()},updateMembers:function(t){this.$emit("updateMembers",t)},rowUpdated:function(t){this.updateMembers(this.members)},customizeText:function(t){if(t.value)return t.value.name}}},f=n(7),h=Object(f.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("DxDataGrid",{attrs:{"data-source":t.members,"remote-operations":!1,"allow-column-reordering":!0,"row-alternation-enabled":!0,showColumnLines:!1,showRowLines:!1},on:{rowUpdated:t.rowUpdated},scopedSlots:t._u([{key:"recipientSelectBox",fn:function(e){var r=e.data;return[n("recipient-select-box",{attrs:{value:r.value},on:{valueChanged:function(e){return t.onValueChanged(e,r)}}})]}}])},[n("DxEditing",{attrs:{"allow-adding":!0,"allow-deleting":!0,"allow-updating":!0,useIcons:!0,mode:"row"}}),t._v(" "),n("DxColumn",{attrs:{fixed:!0,"data-field":"recipient",editCellTemplate:"recipientSelectBox",caption:t.$t("docFlow.automaticAssignmentRules.fields.member"),customizeText:t.customizeText}}),t._v(" "),t._v(" "),n("DxColumn",{attrs:{"data-field":"rightType",caption:t.$t("docFlow.automaticAssignmentRules.fields.rightType")}},[n("DxLookup",{attrs:{"data-source":t.accessRightStore,"value-expr":"id","display-expr":"name"}})],1)],1)],1)}),[],!1,null,null,null).exports,x=n(68),R=n(103),D=n(142),w=n.n(D),v=n(1067),O=n.n(v),y={components:{DxToolbar:w.a,DxItem:D.DxItem},data:function(){return{saveIcon:O.a}},computed:{saveButtonOptions:function(){var t=this;return{icon:O.a,onClick:function(){t.$emit("trySave")}}}}},$=(n(2126),Object(f.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"navBar"},[n("DxToolbar",[n("DxItem",{attrs:{locateInMenu:"auto",options:t.saveButtonOptions,location:"before",widget:"dxButton"}})],1)],1)}),[],!1,null,"ccef87cc",null).exports),A=n(4),_=n(20),C=n.n(_);function F(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function I(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?F(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):F(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var S={components:{Header:R.a,toolbar:$,DxForm:C.a,DxGroupItem:_.DxGroupItem,DxSimpleItem:_.DxSimpleItem,DxRequiredRule:_.DxRequiredRule,DxLabel:_.DxLabel,membersForm:h},props:{isCard:{type:Boolean},currentRule:{type:Object,default:{}}},data:function(){return{id:Number(this.$route.params.id)}},computed:{accessRightRule:function(){return I({name:"",note:"",grantRightsOnLeadingDocument:!0,grantRightsOnExistingDocuments:!0,documentKinds:[],businessUnits:[],departments:[],members:[]},this.currentRule)},isNew:function(){return this.id&&(this.accessRightRule.id=this.id),!this.id},headerTitle:function(){return this.isNew?this.$t("docFlow.automaticAssignmentRules.automaticAssignmentRulesTitle"):this.accessRightRule.name},documentKindsOptions:function(){return I({},(new c.a).withUrl(A.a.docFlow.DocumentKind).filter([["status","=",x.b.Active]]).clearValueExpr().withoutDeferRendering().build(this))},businessUnitsOptions:function(){return I({},(new c.a).withUrl(A.a.company.BusinessUnit).clearValueExpr().filter(["status","=",x.b.Active]).build(this))},departmentsOptions:function(){var filter=[["status","=",x.b.Active]];return I({},(new c.a).withUrl(A.a.company.Department).clearValueExpr().filter(filter).build(this))}},methods:{updateMembers:function(t){this.accessRightRule.members=t},updateRule:function(){var t=this;this.$awn.asyncBlock(this.$axios.put(A.a.accessRights.UpdateRecipient+this.id,this.accessRightRule),(function(e){t.$awn.success(),t.$emit("close")}),(function(e){t.$awn.alert()}))},createRule:function(){var t=this;this.$awn.asyncBlock(this.$axios.post(A.a.accessRights.AddRecipient,this.accessRightRule),(function(e){t.$awn.success(),t.$emit("close")}),(function(e){t.$awn.alert()}))},saveAccessRightRule:function(){this.$refs.form.instance.validate().isValid&&(this.isNew?this.createRule():this.updateRule())}}},B={components:{automaticAssignmentRulesCard:Object(f.a)(S,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Header",{attrs:{headerTitle:t.headerTitle,isbackButton:!t.isCard,isNew:t.isNew}}),t._v(" "),n("toolbar",{attrs:{isCard:t.isCard},on:{trySave:t.saveAccessRightRule}}),t._v(" "),n("form",[n("DxForm",{ref:"form",attrs:{"form-data":t.accessRightRule,"col-count":"2","scrolling-enabled":!0,"show-colon-after-label":!0,"show-validation-summary":!1,"validation-group":"accessRightRule"},scopedSlots:t._u([{key:"params-form",fn:function(){return[n("membersForm",{attrs:{currentMembers:t.accessRightRule.members,isCard:t.isCard},on:{updateMembers:t.updateMembers}})]},proxy:!0}])},[n("DxGroupItem",{attrs:{caption:t.$t("docFlow.automaticAssignmentRules.groups.main")}},[n("DxSimpleItem",{attrs:{"data-field":"name"}},[n("DxRequiredRule",{attrs:{message:t.$t("docFlow.automaticAssignmentRules.validation.requireName")}}),t._v(" "),n("DxLabel",{attrs:{location:"top",text:t.$t("docFlow.automaticAssignmentRules.name")}})],1),t._v(" "),n("DxSimpleItem",{attrs:{"editor-options":t.documentKindsOptions,"editor-type":"dxTagBox","data-field":"documentKinds"}},[n("DxRequiredRule",{attrs:{message:t.$t("docFlow.automaticAssignmentRules.validation.requireDocumentKinds")}}),t._v(" "),n("DxLabel",{attrs:{location:"top",text:t.$t("docFlow.automaticAssignmentRules.documentKinds")}})],1),t._v(" "),n("DxSimpleItem",{attrs:{"editor-options":t.businessUnitsOptions,"editor-type":"dxTagBox","data-field":"businessUnits"}},[n("DxLabel",{attrs:{location:"top",text:t.$t("docFlow.automaticAssignmentRules.businessUnits")}})],1),t._v(" "),n("DxSimpleItem",{attrs:{"editor-options":t.departmentsOptions,"editor-type":"dxTagBox","data-field":"departments"}},[n("DxLabel",{attrs:{location:"top",text:t.$t("docFlow.automaticAssignmentRules.departments")}})],1),t._v(" "),n("DxSimpleItem",{attrs:{"data-field":"grantRightsOnLeadingDocument","editor-type":"dxCheckBox"}},[n("DxLabel",{attrs:{location:"left",text:t.$t("docFlow.automaticAssignmentRules.grantRightsOnLeadingDocument")}})],1),t._v(" "),n("DxSimpleItem",{attrs:{"data-field":"grantRightsOnExistingDocuments","editor-type":"dxCheckBox"}},[n("DxLabel",{attrs:{location:"left",text:t.$t("docFlow.automaticAssignmentRules.grantRightsOnExistingDocuments")}})],1),t._v(" "),n("DxSimpleItem",{attrs:{"data-field":"note","editor-type":"dxTextArea"}},[n("DxLabel",{attrs:{location:"top",text:t.$t("docFlow.automaticAssignmentRules.note")}})],1)],1),t._v(" "),n("DxGroupItem",{attrs:{caption:t.$t("docFlow.automaticAssignmentRules.groups.members")}},[n("DxSimpleItem",{attrs:{template:"params-form"}})],1)],1)],1)],1)}),[],!1,null,null,null).exports},data:function(){return{currentRule:null}},methods:{onClose:function(){this.$router.push("/docFlow/automatic-assignment-rules")}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.$axios,!(r=t.params).id){e.next=9;break}return e.next=4,n.get("".concat(A.a.accessRights.getById+r.id));case 4:return o=e.sent,data=o.data,e.abrupt("return",{currentRule:data});case 9:return e.abrupt("return",{currentRule:null});case 10:case"end":return e.stop()}}),e)})))()}},j=Object(f.a)(B,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("automatic-assignment-rules-card",{attrs:{currentRule:t.currentRule,isCard:!1},on:{close:t.onClose}})}),[],!1,null,null,null);e.default=j.exports}}]);