(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{2304:function(t,e,o){"use strict";o.r(e);o(64);var r=o(68),n=o(27),l=o(4),d=o(103),c=o(67),x={components:{Header:d.a,DxSearchPanel:c.DxSearchPanel,DxDataGrid:c.DxDataGrid,DxColumn:c.DxColumn,DxEditing:c.DxEditing,DxHeaderFilter:c.DxHeaderFilter,DxScrolling:c.DxScrolling,DxLookup:c.DxLookup,DxGrouping:c.DxGrouping,DxGroupPanel:c.DxGroupPanel,DxRequiredRule:c.DxRequiredRule,DxExport:c.DxExport,DxColumnChooser:c.DxColumnChooser,DxColumnFixing:c.DxColumnFixing,DxFilterRow:c.DxFilterRow,DxStateStoring:c.DxStateStoring,DxCustomRule:c.DxCustomRule,DxPatternRule:c.DxPatternRule},data:function(){return{entityType:n.a.CaseFile,store:this.$dxStore({key:"id",loadUrl:l.a.docFlow.CaseFile.All,insertUrl:l.a.docFlow.CaseFile.Value,updateUrl:l.a.docFlow.CaseFile.Value,removeUrl:l.a.docFlow.CaseFile.Value}),indexPattern:this.$store.getters["globalProperties/whitespacePattern"],statusDataSource:this.$store.getters["status/status"](this)}},methods:{edit:function(t){this.$refs.gridContainer.instance.editRow(t.rowIndex)},customizeText:function(t){if(t.value)return t.value.name},validEndDate:function(t){return!t.value||Date.parse(t.data.startDate)<Date.parse(t.value)},onInitNewRow:function(t){t.data.status=this.statusDataSource[r.b.Active].id},onRowUpdating:function(t){t.newData=Object.assign(t.oldData,t.newData)},isAllowUpdating:function(t){return this.canOperateWithCaseFile(t.row.data,"allowUpdating")},isAllowDeleting:function(t){return this.canOperateWithCaseFile(t.row.data,"allowDeleting")},canOperateWithCaseFile:function(t,e){var o=this.$store.getters["permissions/employeeId"];return!!this.$store.getters["permissions/IsAdmin"]||!!this.$store.getters["permissions/".concat(e)](this.entityType)&&(t.registrationGroupResponsibleId==o||!t.registrationGroupResponsibleId)},getAvailableDepartment:function(t){return{store:this.$dxStore({key:"id",loadUrl:l.a.company.Department}),paginate:!0,filter:t.data?["status","=",r.b.Active,"or","id","=",t.data.departmentId]:null}},getAvailableRetentionPeriod:function(t){return{store:this.$dxStore({key:"id",loadUrl:l.a.docFlow.FileRetentionPeriod}),paginate:!0,filter:t.data?["status","=",r.b.Active,"or","id","=",t.data.retentionPeriodId]:null}},getAvailableRegistrationGroups:function(t){return{store:this.$dxStore({key:"id",loadUrl:l.a.docFlow.ResponsibleForGroupOnMe}),paginate:!0,filter:["status","=",r.b.Active]}}}},D=o(7),component=Object(D.a)(x,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("main",[r("Header",{attrs:{headerTitle:t.$t("menu.caseFile")}}),t._v(" "),r("DxDataGrid",{ref:"gridContainer",attrs:{width:"100%",id:"gridContainer","show-borders":!0,"data-source":t.store,"remote-operations":!1,errorRowEnabled:!1,"allow-column-reordering":!0,"allow-column-resizing":!0,"column-auto-width":!0,"load-panel":{enabled:!0,indicatorSrc:o(221)},onRowDblClick:t.edit},on:{"row-updating":t.onRowUpdating,"init-new-row":t.onInitNewRow}},[r("DxGroupPanel",{attrs:{visible:!0}}),t._v(" "),r("DxGrouping",{attrs:{"auto-expand-all":!1}}),t._v(" "),r("DxExport",{attrs:{enabled:!0,"allow-export-selected-data":!0,"file-name":t.$t("docFlow.fields.caseFile")}}),t._v(" "),r("DxFilterRow",{attrs:{visible:!0}}),t._v(" "),r("DxHeaderFilter",{attrs:{visible:!0}}),t._v(" "),r("DxColumnChooser",{attrs:{enabled:!0}}),t._v(" "),r("DxColumnFixing",{attrs:{enabled:!0}}),t._v(" "),r("DxStateStoring",{attrs:{enabled:!0,type:"localStorage","storage-key":"CaseFile"}}),t._v(" "),r("DxEditing",{attrs:{"allow-updating":t.isAllowUpdating,"allow-deleting":t.isAllowDeleting,"allow-adding":t.$store.getters["permissions/allowCreating"](t.entityType),useIcons:!0,mode:"form"}}),t._v(" "),r("DxSearchPanel",{attrs:{position:"after",visible:!0}}),t._v(" "),r("DxScrolling",{attrs:{mode:"virtual"}}),t._v(" "),r("DxColumn",{attrs:{"data-field":"title",caption:t.$t("docFlow.fields.title"),"data-type":"string"}},[r("DxRequiredRule",{attrs:{message:t.$t("docFlow.validation.titleRequired")}})],1),t._v(" "),r("DxColumn",{attrs:{"data-field":"index",caption:t.$t("translations.fields.index"),"data-type":"string"}},[r("DxRequiredRule",{attrs:{message:t.$t("translations.fields.indexRequired")}}),t._v(" "),r("DxPatternRule",{attrs:{"ignore-empty-value":!1,pattern:t.indexPattern,message:t.$t("validation.valueMustNotContainsSpaces")}})],1),t._v(" "),r("DxColumn",{attrs:{"data-field":"startDate",caption:t.$t("docFlow.fields.startDate"),"data-type":"date"}},[r("DxRequiredRule",{attrs:{message:t.$t("docFlow.validation.startDateRequired")}})],1),t._v(" "),r("DxColumn",{attrs:{"data-field":"endDate",caption:t.$t("docFlow.fields.endDate"),"data-type":"date"}},[r("DxCustomRule",{attrs:{message:t.$t("validation.caseFile.endDateLessThanBegin"),"validation-callback":t.validEndDate,type:"custom",reevaluate:!0}})],1),t._v(" "),r("DxColumn",{attrs:{"data-field":"retentionPeriodId",caption:t.$t("docFlow.fields.retentionPeriodId")}},[r("DxRequiredRule",{attrs:{message:t.$t("docFlow.validation.retentionPeriodIdRequired")}}),t._v(" "),r("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getAvailableRetentionPeriod,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),r("DxColumn",{attrs:{"data-field":"location",caption:t.$t("docFlow.fields.location"),visible:!1}}),t._v(" "),r("DxColumn",{attrs:{"data-field":"departmentId",caption:t.$t("translations.fields.departmentId")}},[r("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getAvailableDepartment,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),r("DxColumn",{attrs:{customizeText:t.customizeText,"data-field":"registrationGroup",caption:t.$t("translations.fields.registrationGroupId")}},[r("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getAvailableRegistrationGroups,"display-expr":"name"}})],1),t._v(" "),r("DxColumn",{attrs:{"data-field":"status",caption:t.$t("translations.fields.status")}},[r("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.statusDataSource,"value-expr":"id","display-expr":"status"}})],1),t._v(" "),r("DxColumn",{attrs:{"data-field":"note",caption:t.$t("translations.fields.note"),"data-type":"string",visible:!1}})],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);