(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{2288:function(e,t,n){"use strict";n.r(t);n(48),n(40),n(43),n(50),n(51);var o=n(14),r=n(1034),l=n(291),d=n(374),m=n(163),c=n(68),f=(n(204),n(61),n(20)),x=n.n(f),D=n(4);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h={components:{Header:n(103).a,DxGroupItem:f.DxGroupItem,DxSimpleItem:f.DxSimpleItem,DxLabel:f.DxLabel,DxRequiredRule:f.DxRequiredRule,DxCompareRule:f.DxCompareRule,DxPatternRule:f.DxPatternRule,DxRangeRule:f.DxRangeRule,DxEmailRule:f.DxEmailRule,DxForm:x.a,DxAsyncRule:f.DxAsyncRule,Toolbar:m.a,BusinessUnitSelectBox:l.a,DepartmentSelectBox:d.a,ImageUploader:r.a},props:["isCard"],data:function(){return{employee:{email:null,firstName:null,lastName:null,middleName:null,phone:null,jobTitleId:null,businessUnit:null,department:null,note:null,userName:null,password:null,confirmPassword:null,personalPhoto:null},passwordOptions:{mode:"password"},jobTitleOptions:this.$store.getters["globalProperties/FormOptions"]({context:this,url:D.a.company.JobTitle,filter:["status","=",c.b.Active]})}},computed:{businessUnitId:function(){var e;return null===(e=this.employee.businessUnit)||void 0===e?void 0:e.id},businessUnit:function(){return this.employee.businessUnit},department:function(){return this.employee.department},departmentOptions:function(){return y(y({},this.$store.getters["globalProperties/FormOptions"]({context:this,url:D.a.company.Department,filter:[["status","=",0],["businessUnitId","=",this.employee.businessUnitId]]})),{},{value:this.employee.departmentId})}},methods:{setDepartment:function(data){this.employee.department=data},setPhoto:function(data){this.employee.personalPhoto=data},setBusinessUnit:function(data){this.employee.businessUnit=data},passwordComparison:function(){return this.employee.password},validateEntityExists:function(e){var t=e.formItem.dataField;return this.$customValidator.EmployeeDataFieldValueNotExists(Object(o.a)({},t,e.value),t)},generateFormData:function(data){function e(e,n){null!==n&&t.append(e,n)}var t=new FormData;return e("userName",data.userName),e("email",data.email),e("firstName",data.firstName),e("lastName",data.lastName),e("middleName",data.middleName),e("phone",data.phone),e("jobTitleId",data.jobTitleId),e("departmentId",data.department.id),e("password",data.password),e("confirmPassword",data.confirmPassword),e("note",data.note),e("personalPhoto","string"==typeof data.personalPhoto?null:data.personalPhoto),t},handleSubmit:function(){var e=this,t=this.$refs.form.instance.validate(),n=this.generateFormData(this.employee);t.isValid&&this.$awn.asyncBlock(this.$axios.post(D.a.company.Employee,n),(function(t){e.isCard?e.$parent.$parent.openCard():e.$router.go(-1),e.$awn.success()}),(function(t){return e.$awn.alert()}))}}},R=n(7),I={components:{employeeCardCreate:Object(R.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Header",{attrs:{headerTitle:this.$t("menu.addingEmployee"),isbackButton:!e.isCard,isNew:!0}}),e._v(" "),n("toolbar",{attrs:{canSave:!0},on:{saveChanges:e.handleSubmit}}),e._v(" "),n("DxForm",{ref:"form",attrs:{"col-count":2,"form-data":e.employee,"show-colon-after-label":!0,"show-validation-summary":!0,"validation-group":"createEmployee"},on:{"update:formData":function(t){e.employee=t},"update:form-data":function(t){e.employee=t}},scopedSlots:e._u([{key:"businessUnitSelectBox",fn:function(){return[n("business-unit-select-box",{attrs:{value:e.businessUnit,"read-only":e.isCard,validatorGroup:"createEmployee",isRequired:!0},on:{valueChanged:function(data){e.setBusinessUnit(data),e.setDepartment(null)}}})]},proxy:!0},{key:"departmentSelectBox",fn:function(){return[n("department-select-box",{attrs:{"read-only":e.isCard,value:e.department,validatorGroup:"createEmployee",isRequired:!0,businessUnitId:e.businessUnitId},on:{valueChanged:function(data){e.setDepartment(data)}}})]},proxy:!0},{key:"imageUploader",fn:function(){return[n("image-uploader",{on:{valueChanged:function(data){e.setPhoto(data)}}})]},proxy:!0}])},[n("DxGroupItem",{attrs:{caption:e.$t("translations.fields.personalData")}},[n("DxGroupItem",{attrs:{"col-count":5}},[n("DxSimpleItem",{attrs:{template:"imageUploader","col-span":1}},[n("DxLabel",{attrs:{location:"top",text:"Фото"}})],1),e._v(" "),n("DxGroupItem",{attrs:{"col-span":4}},[n("DxSimpleItem",{attrs:{"data-field":"userName","data-type":"string"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.userName")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("translations.fields.userNameRequired")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"data-field":"firstName"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.firstName")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("translations.fields.fullNameRequired")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"data-field":"lastName"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.lastName")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("translations.fields.fullNameRequired")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"data-field":"middleName"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.middleName")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"data-field":"email"}},[n("DxLabel",{attrs:{location:"top"}}),e._v(" "),n("DxEmailRule",{attrs:{message:e.$t("translations.fields.emailRule")}}),e._v(" "),n("DxAsyncRule",{attrs:{"ignore-empty-value":!0,reevaluate:!1,"validation-callback":e.validateEntityExists,message:e.$t("translations.fields.emailAlreadyExists")}})],1)],1)],1),e._v(" "),n("DxSimpleItem",{attrs:{"editor-options":e.passwordOptions,"data-field":"password"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.password")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("translations.fields.passwordRequired")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"editor-options":e.passwordOptions,"editor-type":"dxTextBox","data-field":"confirmPassword"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.confirmPassword")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("translations.fields.confirmPasswordRequired")}}),e._v(" "),n("DxCompareRule",{attrs:{"comparison-target":e.passwordComparison,message:e.$t("translations.fields.confirmPasswordRule")}})],1)],1),e._v(" "),n("DxGroupItem",{attrs:{caption:e.$t("translations.fields.APN")}},[n("DxSimpleItem",{attrs:{"data-field":"jobTitleId","editor-options":e.jobTitleOptions,"editor-type":"dxSelectBox"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.jobTitleId")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("translations.fields.jobTitleIdRequired")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"data-field":"businessUnit",template:"businessUnitSelectBox"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("document.fields.businessUnitId")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("document.validation.businessUnitIdRequired")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"data-field":"department",template:"departmentSelectBox"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.departmentId")}}),e._v(" "),n("DxRequiredRule",{attrs:{message:e.$t("translations.fields.departmentIdRequired")}})],1),e._v(" "),n("DxSimpleItem",{attrs:{"data-field":"phone"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.phones")}})],1)],1),e._v(" "),n("DxGroupItem",{attrs:{"col-span":2}},[n("DxSimpleItem",{attrs:{"data-field":"note","editor-options":{height:90},"editor-type":"dxTextArea"}},[n("DxLabel",{attrs:{location:"top",text:e.$t("translations.fields.note")}})],1)],1)],1)],1)}),[],!1,null,null,null).exports}},w=Object(R.a)(I,(function(){var e=this.$createElement;return(this._self._c||e)("employee-card-create",{attrs:{isCard:!1}})}),[],!1,null,null,null);t.default=w.exports}}]);