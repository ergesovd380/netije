(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1892:function(t,e,n){"use strict";var o=n(49),r=(n(4),{components:{DxTextArea:o.DxTextArea},props:{value:{type:String,default:function(){return""}},onValueChanged:{type:Function,default:function(){return function(){}}}},data:function(){return{currentValue:this.value}},methods:{}}),l=n(7),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",[n("DxTextArea",{attrs:{value:t.currentValue,height:90,"on-value-changed":function(e){return t.onValueChanged(e.value)}},on:{"update:value":function(e){t.currentValue=e}}})],1)}),[],!1,null,null,null);e.a=component.exports},2317:function(t,e,n){"use strict";n.r(e);var o,r=n(14),l=n(68),d=n(27),c=n(4),m=n(103),x=n(1033),D=n(1892),f=n(1070),v={components:(o={MemberList:x.a,textArea:D.a,DxColumn:f.DxColumn,Header:m.a,DxSearchPanel:f.DxSearchPanel,DxTreeList:f.DxTreeList},Object(r.a)(o,"DxColumn",f.DxColumn),Object(r.a)(o,"DxEditing",f.DxEditing),Object(r.a)(o,"DxHeaderFilter",f.DxHeaderFilter),Object(r.a)(o,"DxScrolling",f.DxScrolling),Object(r.a)(o,"DxLookup",f.DxLookup),Object(r.a)(o,"DxRequiredRule",f.DxRequiredRule),Object(r.a)(o,"DxPatternRule",f.DxPatternRule),Object(r.a)(o,"DxAsyncRule",f.DxAsyncRule),Object(r.a)(o,"DxExport",f.DxExport),Object(r.a)(o,"DxColumnChooser",f.DxColumnChooser),Object(r.a)(o,"DxColumnFixing",f.DxColumnFixing),Object(r.a)(o,"DxFilterRow",f.DxFilterRow),Object(r.a)(o,"DxStateStoring",f.DxStateStoring),o),data:function(){return{currentEmployee:null,employeeEntityType:d.a.Employee,entityType:d.a.Department,dataSource:this.$dxStore({key:"id",loadUrl:c.a.company.Department,insertUrl:c.a.company.Department,updateUrl:c.a.company.Department,removeUrl:c.a.company.Department}),statusDataSource:this.$store.getters["status/status"](this),onBusinessUnitIdChanged:function(t,e){t.code=t.code,this.defaultSetCellValue(t,e)},codePattern:this.$store.getters["globalProperties/whitespacePattern"]}},computed:{editButtons:function(){var t=this;return[{hint:this.$t("translations.fields.members"),icon:"card",visible:this.$store.getters["permissions/allowReading"](this.employeeEntityType),onClick:function(e){t.currentEmployee=e.row.data,t.openPopup()}},"add","edit","delete"]}},methods:{selectDepartment:function(t){this.$refs.department.instance.editRow(t.rowIndex)},openPopup:function(){this.$popup.memberList(this,{currentEmployee:this.currentEmployee},{showLoadingPanel:!1,height:"auto",position:"flex-start"})},onInitNewRow:function(t){t.data.status=this.statusDataSource[l.b.Active].id,0===t.data.headOfficeId&&(t.data.headOfficeId=null)},onRowUpdating:function(t){t.newData=Object.assign(t.oldData,t.newData)},allowDeleting:function(t){return t.row.data.isSystem?!t.row.data.isSystem:this.$store.getters["permissions/allowDeleting"](this.entityType)},getActiveHeadOffices:function(t){return{store:this.$dxStore({key:"id",loadUrl:c.a.company.Department}),paginate:!0,filter:t.data?["businessUnitId","=",t.data.businessUnitId,"or","status","=",l.b.Active,"or","id","=",t.data.headOfficeId]:void 0}},getActiveEmployees:function(t){return{store:this.$dxStore({key:"id",loadUrl:c.a.company.Employee}),paginate:!0,filter:t.data?["status","=",l.b.Active,"or","id","=",t.data.ceo]:void 0}},getActiveBussinessUnit:function(t){return{store:this.$dxStore({key:"id",loadUrl:c.a.company.BusinessUnit}),paginate:!0,filter:t.data?["status","=",l.b.Active,"or","id","=",t.data.businessUnitId]:void 0}},onValueChanged:function(t,e){e.setValue(t),e.component.updateDimensions()}}},h=n(7),component=Object(h.a)(v,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("main",[o("Header",{attrs:{headerTitle:t.$t("menu.department")}}),t._v(" "),o("div",[o("DxTreeList",{ref:"department",attrs:{"remoteOperations:":"","{":"","filtering:":"","true,sorting:":"","true,grouping:":"",true:"","}":"","parent-id-expr":"headOfficeId","data-source":t.dataSource,errorRowEnabled:!1,"show-borders":!0,"column-auto-width":!0,"allow-column-reordering":!0,"allow-column-resizing":!0,"load-panel":{enabled:!0,indicatorSrc:n(221)},onRowDblClick:t.selectDepartment},on:{"row-updating":t.onRowUpdating,"init-new-row":t.onInitNewRow},scopedSlots:t._u([{key:"textAreaEditor",fn:function(e){return[o("textArea",{attrs:{value:e.data.value,"on-value-changed":function(n){return t.onValueChanged(n,e.data)}}})]}}])},[o("DxSearchPanel",{attrs:{position:"after",visible:!0}}),t._v(" "),o("DxFilterRow",{attrs:{visible:!0}}),t._v(" "),o("DxHeaderFilter",{attrs:{visible:!0}}),t._v(" "),o("DxColumnChooser",{attrs:{enabled:!0}}),t._v(" "),o("DxColumnFixing",{attrs:{enabled:!0}}),t._v(" "),o("DxScrolling",{attrs:{mode:"virtual"}}),t._v(" "),o("DxStateStoring",{attrs:{enabled:!0,type:"localStorage","storage-key":"department"}}),t._v(" "),o("DxEditing",{attrs:{"allow-updating":t.$store.getters["permissions/allowUpdating"](t.entityType),"allow-deleting":t.allowDeleting,"allow-adding":t.$store.getters["permissions/allowCreating"](t.entityType),useIcons:!0,mode:"form"}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"name",caption:t.$t("shared.name"),"data-type":"string"}},[o("DxRequiredRule",{attrs:{message:t.$t("shared.nameRequired")}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"phone",caption:t.$t("translations.fields.phones"),visible:!1}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"code",caption:t.$t("shared.code"),visible:!1}},[o("DxPatternRule",{attrs:{"ignore-empty-value":!1,pattern:t.codePattern,message:t.$t("validation.valueMustNotContainsSpaces")}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"shortName",caption:t.$t("shared.shortName")}}),t._v(" "),o("DxColumn",{attrs:{"data-field":"headOfficeId",caption:t.$t("translations.fields.headOfficeId"),visible:!1}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getActiveHeadOffices,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"managerId",caption:t.$t("translations.fields.managerId")}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.getActiveEmployees,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"businessUnitId",caption:t.$t("translations.fields.businessUnitId"),"set-cell-value":t.onBusinessUnitIdChanged}},[o("DxRequiredRule",{attrs:{message:t.$t("translations.fields.businessUnitIdRequired")}}),t._v(" "),o("DxLookup",{attrs:{"data-source":t.getActiveBussinessUnit,"value-expr":"id","display-expr":"name"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"status",caption:t.$t("translations.fields.status")}},[o("DxLookup",{attrs:{"allow-clearing":!0,"data-source":t.statusDataSource,"value-expr":"id","display-expr":"status"}})],1),t._v(" "),o("DxColumn",{attrs:{"data-field":"note",caption:t.$t("translations.fields.note"),visible:!1,"edit-cell-template":"textAreaEditor"}}),t._v(" "),o("DxColumn",{attrs:{width:110,buttons:t.editButtons,type:"buttons"}})],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);